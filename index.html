<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8"/>
  <meta name="viewport" content="width=device-width,initial-scale=1"/>
  <title>Oracle Ethics M1</title>
  <link rel="stylesheet" href="./styles.css"/>
  <script>
    // Set your backend URL here (Render)
    window.BACKEND_URL = "https://oracle-philosophy-backend.onrender.com";
  </script>
</head>
<body>
<header class="topbar">
  <div class="brand">Oracle Ethics M1</div>
  <nav>
    <a href="#oracle">Oracle</a>
    <a href="#dashboard">Transparency</a>
    <a href="#docs">Docs</a>
    <a href="#contact">Contact</a>
  </nav>
</header>

<main>
  <!-- ORACLE -->
  <section id="oracle" class="card">
    <h2>Consult the Oracle</h2>
    <div class="form-row">
      <label>Question</label>
      <textarea id="q" rows="3" placeholder="Ask anything… e.g. Will Bitcoin rise tomorrow?"></textarea>
    </div>
    <div class="form-row">
      <label>Session ID (optional)</label>
      <input id="sid" placeholder="auto-generate if empty"/>
    </div>
    <button id="askBtn">Seek the Truth</button>

    <div id="answerBox" class="answer hide">
      <h3>Oracle's Reply</h3>
      <p id="answerText"></p>
      <div class="metrics">
        <div>Kind: <span id="kind"></span></div>
        <div>Determinacy: <span id="det"></span></div>
        <div>Deception Prob.: <span id="dec"></span></div>
        <div>Risk Tags: <span id="risk"></span></div>
      </div>
    </div>
  </section>

  <!-- DASHBOARD -->
  <section id="dashboard" class="card">
    <h2>Transparency Dashboard</h2>
    <div class="stats">
      <div><b>Requests (latest)</b>: <span id="reqCount">0</span></div>
      <div><b>Truthful Rate</b>: <span id="truthRate">—</span></div>
      <div><b>Avg. Deception Prob.</b>: <span id="avgDec">—</span></div>
      <div><b>Avg. Determinacy</b>: <span id="avgDet">—</span></div>
    </div>

    <table class="table" id="logTable">
      <thead>
        <tr>
          <th>Time</th><th>Type</th><th>Question</th><th>Answer</th>
          <th>Determ.</th><th>Decep.</th><th>Risk</th>
        </tr>
      </thead>
      <tbody id="logBody"></tbody>
    </table>
    <button id="refreshBtn">Refresh Logs</button>
  </section>

  <!-- DOCS -->
  <section id="docs" class="card">
    <h2>Docs (Short)</h2>
    <details>
      <summary>What is the Determinacy Index?</summary>
      <p>
        A lightweight score (0–1) estimating how specific and operational the answer is.
        Short, directive responses trend higher; vague, long responses trend lower.
      </p>
    </details>
    <details>
      <summary>How do you detect deception?</summary>
      <p>
        We scan for absolutist phrasing or risky domains (finance, medical) and raise a deception
        probability. If the probability crosses a threshold, the oracle deliberately emits a
        “deceptive prophecy”, which is fully recorded on the audit chain.
      </p>
    </details>
    <details>
      <summary>Audit Chain</summary>
      <p>
        Every response is appended to an append-only JSONL ledger with a cryptographic hash chain
        (prev_hash + entry_hash). Anyone can verify integrity by recomputing the chain hashes.
      </p>
    </details>
  </section>

  <!-- CONTACT -->
  <section id="contact" class="card">
    <h2>Contact</h2>
    <p>Email: <a href="mailto:renshijian0258@proton.me">renshijian0258@proton.me</a></p>
    <p>Telegram: <a href="https://t.me/renshijian0" target="_blank">t.me/renshijian0</a></p>
  </section>
</main>

<footer class="footer">
  <span>“After the blackout, the true light appears.”</span>
</footer>

<script src="./main.js"></script>
</body>
</html>